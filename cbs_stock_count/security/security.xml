<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- Security Rule: Attendees can only see sessions they are part of        -->
    <record id="stock_count_session_attendee_rule" model="ir.rule">
        <field name="name">Count Session: Attendees Only</field>
        <field name="model_id" ref="model_stock_count_session"/>
        <field name="domain_force">[
            "|",
            ("attendee_ids", "in", [user.id]),
            ("user_id", "=", user.id)
        ]</field>
        <field name="groups" eval="[(4, ref('stock.group_stock_user'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="True"/>
        <field name="perm_create" eval="True"/>
        <field name="perm_unlink" eval="False"/>
    </record>

    <!-- Security Rule: Managers can see all sessions                           -->
    <record id="stock_count_session_manager_rule" model="ir.rule">
        <field name="name">Count Session: Managers See All</field>
        <field name="model_id" ref="model_stock_count_session"/>
        <field name="domain_force">[(1, "=", 1)]</field>
        <field name="groups" eval="[(4, ref('stock.group_stock_manager'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="True"/>
        <field name="perm_create" eval="True"/>
        <field name="perm_unlink" eval="True"/>
    </record>

    <!-- Security Rule: Finance Manager can see all sessions and approve/reject -->
    <record id="stock_count_session_finance_manager_rule" model="ir.rule">
        <field name="name">Count Session: Finance Manager</field>
        <field name="model_id" ref="model_stock_count_session"/>
        <field name="domain_force">[(1, "=", 1)]</field>
        <field name="groups" eval="[(4, ref('base.group_finance_manager'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="True"/>
        <field name="perm_create" eval="False"/>
        <field name="perm_unlink" eval="False"/>
    </record>

</odoo>
